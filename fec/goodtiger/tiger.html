<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>TIGRINHO DO BEM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        /* ======= CONFIGURE AQUI SUA IMAGEM DE FUNDO =======
          Tamanho recomendado: 1920x1080px (ou maior, paisagem)
          Exemplo de imagem gr√°tis: https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1920&q=80
        */
        background: url("fundinho.jpg") no-repeat center center fixed;
        background-size: cover;
        color: #fff;
        font-family: "Segoe UI", Arial, sans-serif;
        min-height: 100vh;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow-x: hidden; /* Evita barra de rolagem horizontal em telas pequenas */
      }

      .container {
        max-width: 1600px; /* ALTERA√á√ÉO: Aumenta ainda mais para acomodar pain√©is bem afastados */
        margin: 40px auto;
        background: rgba(30, 30, 30, 0.92);
        border-radius: 28px;
        box-shadow: 0 12px 48px 0 #000a, 0 0 0 8px #ffd70044;
        padding: 36px 28px 28px 28px;
        text-align: center;
        position: relative;
        z-index: 2;
        display: none; /* Escondido por padr√£o, ser√° exibido pelo JS */
        overflow: visible; /* ALTERA√á√ÉO: Permite que pain√©is externos sejam vis√≠veis */
      }

      h1 {
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-size: 2.7rem;
        letter-spacing: 2px;
        margin-bottom: 18px;
        color: #ffd700;
        text-shadow: 0 4px 16px #000, 0 2px 0 #ff9800, 0 0 24px #ffd70099;
        animation: pop 1.2s cubic-bezier(0.17, 0.67, 0.83, 0.67) infinite
          alternate;
      }
      @keyframes pop {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(1.04);
        }
      }

      .slot-area {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 22px;
        margin: 36px 0 18px 0;
        background: rgba(24, 24, 24, 0.98);
        border-radius: 22px;
        box-shadow: 0 0 32px #000a, 0 0 0 6px #ffd70055;
        padding: 18px 0;
        border: 3px solid #ffd700;
        position: relative;
        z-index: 1; /* Garante que a roleta fique por cima de outros elementos se necess√°rio */
      }
      
      /* ALTERA√á√ÉO: Linha vencedora no centro da roleta */
      .slot-area::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, transparent 0%, #ffd700 20%, #ff9800 50%, #ffd700 80%, transparent 100%);
        box-shadow: 0 0 20px #ffd700, 0 0 40px #ffd700aa;
        border-radius: 2px;
        z-index: 10;
        animation: linhaBrilho 2s infinite alternate;
      }
      
      @keyframes linhaBrilho {
        from {
          box-shadow: 0 0 20px #ffd700, 0 0 40px #ffd700aa;
        }
        to {
          box-shadow: 0 0 30px #ffd700, 0 0 60px #ffd700cc, 0 0 80px #ffd70088;
        }
      }
      .slot-area::before {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 22px;
        box-shadow: 0 0 60px 10px #ffd70044 inset;
        pointer-events: none;
      }

      .slot-window {
        width: 140px;
        height: 420px;
        background: linear-gradient(180deg, #222 80%, #ffd70022 100%);
        border-radius: 18px;
        box-shadow: 0 0 18px #000a, 0 0 0 3px #ffd700;
        border: 4px solid #fff;
        overflow: hidden;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .slot-strip {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        transition: top 0.3s cubic-bezier(0.17, 0.67, 0.83, 0.67);
      }

      .slot-symbol {
        width: 140px;
        height: 140px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 1.15rem;
        color: #fff;
        background: linear-gradient(135deg, #e74c3c 0%, #f1c40f 100%);
        border-bottom: 2px solid #fff3;
        box-shadow: 0 2px 8px #0003 inset, 0 0 0 4px #fff2 inset;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-weight: bold;
        letter-spacing: 1px;
        text-shadow: 0 2px 6px #000a, 0 0 8px #ffd70099;
        transition: box-shadow 0.2s;
      }
      .slot-symbol img {
        max-width: 120px;
        max-height: 120px;
        margin-bottom: 4px;
        display: block;
        filter: drop-shadow(0 2px 4px #0008) drop-shadow(0 0 8px #ffd70088);
        border-radius: 12px;
        background: #fff2;
        padding: 2px;
      }

      .game-buttons {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
      }
      .game-buttons button {
        background: linear-gradient(90deg, #ffd700 0%, #ff9800 100%);
        color: #222;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-size: 1.4rem;
        font-weight: bold;
        border: none;
        border-radius: 30px;
        padding: 16px 48px;
        cursor: pointer;
        box-shadow: 4px 4px 24px #0008, 0 0 0 4px #ffd70055;
        transition: background 0.2s, transform 0.2s, box-shadow 0.2s;
        letter-spacing: 1px;
        text-shadow: 0 2px 8px #fff8;
        width: 100%;
        max-width: 300px;
      }
      .game-buttons button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        background: linear-gradient(90deg, #666 0%, #888 100%);
        transform: none;
        box-shadow: 2px 2px 12px rgba(0,0,0,0.2), 0 0 0 2px rgba(102,102,102,0.3);
      }
      .game-buttons button:hover:not(:disabled) {
        background: linear-gradient(90deg, #ff9800 0%, #ffd700 100%);
        transform: scale(1.06);
        box-shadow: 0 8px 32px #ffd70088, 0 0 0 8px #ffd70033;
      }

      .result {
        margin: 18px 0 28px 0;
        font-size: 1.5rem;
        color: #00e676;
        min-height: 32px;
        text-shadow: 0 2px 8px #000a, 0 0 12px #ffd70099;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        letter-spacing: 1px;
      }

      .linha-premiada {
        box-shadow: 0 0 0 6px #ffd700, 0 0 32px #ffd700a0;
        border-radius: 14px;
        animation: brilho 1s infinite alternate;
      }
      @keyframes brilho {
        from {
          box-shadow: 0 0 0 6px #ffd700, 0 0 32px #ffd700a0;
        }
        to {
          box-shadow: 0 0 0 12px #fff700, 0 0 60px #fff700c0;
        }
      }

      .popup-overlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(20, 20, 20, 0.75);
        z-index: 1000;
        animation: fadeIn 0.3s;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .popup-msg {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        gap: 36px;
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%) scale(1);
        z-index: 1001;
        background: linear-gradient(135deg, #fffbe9 80%, #ffd700 100%);
        border-radius: 32px;
        box-shadow: 0 8px 64px #000a, 0 0 0 8px #ffd70055;
        padding: 38px 48px 38px 38px;
        min-width: 340px;
        max-width: 90vw;
        min-height: 180px;
        animation: popupIn 0.5s cubic-bezier(0.17, 0.67, 0.83, 0.67);
      }
      @keyframes popupIn {
        from {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.7);
        }
        to {
          opacity: 1;
          transform: translate(-50%, -50%) scale(1);
        }
      }

      .popup-msg img {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        box-shadow: 0 4px 24px #000a, 0 0 0 8px #ffd70055;
        background: #fff;
        object-fit: contain;
        border: 4px solid #ffd700;
        animation: mascoteBounce 1.2s infinite alternate;
      }
      @keyframes mascoteBounce {
        from {
          transform: translateY(0);
        }
        to {
          transform: translateY(-14px);
        }
      }

      .balao-fala {
        background: #fffbe9;
        color: #222;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-size: 1.5rem;
        border-radius: 22px;
        box-shadow: 0 4px 24px #0004, 0 0 0 4px #ffd70033;
        padding: 24px 32px;
        position: relative;
        text-align: left;
        line-height: 1.3;
        min-width: 220px;
        max-width: 340px;
        animation: falaPop 0.7s cubic-bezier(0.17, 0.67, 0.83, 0.67);
      }
      @keyframes falaPop {
        from {
          opacity: 0;
          transform: scale(0.7);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .balao-fala::after {
        content: "";
        position: absolute;
        left: -28px;
        bottom: 28px;
        width: 0;
        height: 0;
        border-top: 22px solid transparent;
        border-bottom: 22px solid transparent;
        border-right: 28px solid #fffbe9;
        filter: drop-shadow(-2px 2px 2px #ffd70044);
      }

      .popup-close {
        position: absolute;
        top: 18px;
        right: 22px;
        background: #ffd700;
        color: #222;
        border: none;
        border-radius: 50%;
        width: 38px;
        height: 38px;
        font-size: 2rem;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        cursor: pointer;
        box-shadow: 0 2px 8px #0004;
        transition: background 0.2s;
        z-index: 10;
      }
      .popup-close:hover {
        background: #ff9800;
        color: #fff;
      }

      @media (max-width: 1000px) {
        .container {
          max-width: 90vw; /* ALTERA√á√ÉO: Em telas m√©dias, reduz a largura m√°xima */
        }
        .slot-layout {
          gap: 20px; /* ALTERA√á√ÉO: Reduz o gap em telas m√©dias */
        }
        .slot-layout > div:nth-child(2) {
          width: 100%; /* ALTERA√á√ÉO: Em telas m√©dias, o painel central √© responsivo */
          max-width: 480px;
        }
      }

      @media (max-width: 700px) {
        .container,
        .slot-area {
          max-width: 99vw;
          width: 99vw;
        }
        .slot-area {
          gap: 8px;
        }
        .slot-window {
          width: 80px;
          height: 240px;
        }
        .slot-symbol {
          width: 80px;
          height: 80px;
        }
        .slot-symbol img {
          max-width: 70px;
          max-height: 70px;
        }
        .popup-msg img {
          width: 64px;
          height: 64px;
        }
        .popup-msg {
          padding: 18px 10px 18px 10px;
          min-width: 0;
        }
        .balao-fala {
          font-size: 1rem;
          min-width: 90px;
          padding: 10px 12px;
        }
        .balao-fala::after {
          left: -12px;
          border-top: 10px solid transparent;
          border-bottom: 10px solid transparent;
          border-right: 12px solid #fffbe9;
        }
        #back-arrow {
          font-size: 3rem; /* Menor em telas pequenas */
          left: 15px;
          top: 15px;
        }

        /* ALTERA√á√ÉO: responsivo para layout lateral (info / roleta / ranking) */
        .slot-layout {
          flex-direction: column;
          align-items: center;
          gap: 20px; /* ALTERA√á√ÉO: Reduz o gap em telas menores */
        }
        .side-panel {
          width: 100%;
          max-width: 520px;
        }
        .slot-layout > div:nth-child(2) {
          width: 100%; /* ALTERA√á√ÉO: Em telas menores, o painel central ocupa toda a largura */
          max-width: 520px;
        }
      }

      /* ==== Estilos das Novas P√°ginas (Intro, Cr√©ditos e Ranking) ==== */
      .intro-page,
      .credits-page,
      .score-page {
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 40px;
        background: rgba(30, 30, 30, 0.92);
        border-radius: 28px;
        box-shadow: 0 12px 48px 0 #000a, 0 0 0 8px #ffd70044;
        max-width: 480px;
        width: 90%;
        position: relative;
        z-index: 2;
      }
      .intro-page h1,
      .score-page h1 {
        margin-bottom: 40px;
      }

      .intro-page button,
      .credits-page button,
      .score-page button {
        background: linear-gradient(90deg, #ffd700 0%, #ff9800 100%);
        color: #222;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-size: 1.4rem;
        font-weight: bold;
        border: none;
        border-radius: 30px;
        padding: 16px 48px;
        margin: 10px 0;
        cursor: pointer;
        box-shadow: 4px 4px 24px #0008, 0 0 0 4px #ffd70055;
        transition: background 0.2s, transform 0.2s, box-shadow 0.2s;
        letter-spacing: 1px;
        text-shadow: 0 2px 8px #fff8;
        width: 100%;
        max-width: 300px;
      }
      .intro-page button:hover,
      .credits-page button:hover,
      .score-page button:hover {
        background: linear-gradient(90deg, #ff9800 0%, #ffd700 100%);
        transform: scale(1.06);
        box-shadow: 0 8px 32px #ffd70088, 0 0 0 8px #ffd70033;
      }

      .credits-page {
        max-width: 540px;
      }
      .credits-page h2 {
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        color: #ffd700;
        text-shadow: 0 2px 8px #000a;
        margin-bottom: 20px;
      }
      .credits-page p,
      .score-page p {
        font-size: 1.5rem; /* Um pouco maior */
        line-height: 1.8;
        margin: 8px 0;
        color: #fff;
        text-shadow: 0 2px 8px #000a, 0 0 12px #ffd700; /* Mais brilho */
        font-family: "Luckiest Guy", cursive, Arial, sans-serif; /* Mesma fonte do t√≠tulo */
        letter-spacing: 1px;
      }
      .credits-page p.thanks {
        margin-top: 40px; /* Mais espa√ßamento */
        font-size: 1.8rem; /* Ainda maior */
        font-weight: bold;
        color: #222; /* Cor mais escura para contraste */
        text-shadow: 0 2px 8px #fff8; /* Sombra branca */
        background: linear-gradient(
          135deg,
          #ffd700 0%,
          #ff9800 100%
        ); /* Gradiente de dourado/laranja */
        padding: 15px 30px;
        border-radius: 15px;
        box-shadow: 0 4px 24px #000a, 0 0 0 6px #fff70055; /* Sombra e borda mais acentuadas */
        animation: pop 1s infinite alternate; /* Anima√ß√£o de "pulo" tamb√©m na mensagem */
      }

      #back-arrow {
        position: fixed;
        top: 25px;
        left: 25px;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-size: 4rem;
        color: #ffd700;
        text-shadow: 0 4px 16px #000, 0 2px 0 #ff9800, 0 0 24px #ffd70099;
        cursor: pointer;
        z-index: 100;
        animation: pop 1.2s cubic-bezier(0.17, 0.67, 0.83, 0.67) infinite
          alternate;
        display: none;
        transition: transform 0.2s;
      }
      #back-arrow:hover {
        transform: scale(1.1);
      }

      /* Estilos para o novo contador de jogadas */
      /* ALTERA√á√ÉO: deixou de ser absoluto/por cima da roleta; agora vai numa lateral */
      .game-info {
        position: static; /* ALTERA√á√ÉO */
        top: auto;
        right: auto; /* ALTERA√á√ÉO */
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-size: 1.2rem;
        text-align: left; /* ALTERA√á√ÉO */
      }

      /* ======= ALTERA√á√ÉO: layout com pain√©is externos ======= */
      .slot-layout {
        /* ALTERA√á√ÉO */
        display: flex;
        align-items: flex-start;
        justify-content: center; /* ALTERA√á√ÉO: Centraliza a roleta */
        width: 100%;
        max-width: 1600px; /* ALTERA√á√ÉO: Aumenta para acomodar pain√©is bem afastados */
        position: relative; /* ALTERA√á√ÉO: Para posicionar pain√©is externos */
      }
      .side-panel {
        /* ALTERA√á√ÉO */
        background: rgba(30, 30, 30, 0.92);
        border-radius: 20px;
        box-shadow: 0 0 15px #000a, 0 0 0 4px #ffd70044;
        padding: 20px 18px; /* ALTERA√á√ÉO: Aumentei o padding interno */
        min-width: 180px;
        flex-shrink: 0; /* ALTERA√á√ÉO: Impede que o painel encolha */
        position: absolute; /* ALTERA√á√ÉO: Posiciona externamente */
        top: 0;
      }
      
      /* ALTERA√á√ÉO: Painel de usu√°rio/jogadas no canto superior esquerdo */
      .side-panel:first-child {
        left: -450px; /* ALTERA√á√ÉO: Ainda mais afastado para nomes longos */
        top: -50px; /* ALTERA√á√ÉO: Posiciona no canto superior */
      }
      
      /* ALTERA√á√ÉO: Painel de ranking no canto superior direito */
      .ranking-panel {
        right: -450px; /* ALTERA√á√ÉO: Ainda mais afastado para nomes longos */
        top: -50px; /* ALTERA√á√ÉO: Posiciona no canto superior */
        max-width: 350px; /* ALTERA√á√ÉO: Largura maior para nomes longos */
      }
      .ranking-panel .title {
        /* ALTERA√á√ÉO */
        color: #ffd700;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        margin: 0 0 10px 0;
        text-align: center;
      }
      .ranking-list {
        /* ALTERA√á√ÉO */
        list-style: none;
        margin: 0;
        padding: 0;
        display: grid;
        gap: 8px;
      }
      .ranking-item {
        /* ALTERA√á√ÉO */
        background: rgba(255, 215, 0, 0.15);
        border-radius: 12px;
        padding: 8px 10px;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-size: 0.95rem;
      }

      /* ======= ALTERA√á√ÉO (popup de nome usando o mesmo estilo visual) ======= */
      #name-overlay {
        /* ALTERA√á√ÉO */
        display: none;
      }
      #name-popup .balao-fala input {
        /* ALTERA√á√ÉO */
        width: 100%;
        margin-top: 10px;
        margin-bottom: 12px;
        padding: 10px 12px;
        border-radius: 12px;
        border: none;
        font-size: 1rem;
      }
      #name-popup .balao-fala button {
        /* ALTERA√á√ÉO */
        background: linear-gradient(90deg, #ffd700 0%, #ff9800 100%);
        color: #222;
        font-family: "Luckiest Guy", cursive, Arial, sans-serif;
        font-size: 1.1rem;
        font-weight: bold;
        border: none;
        border-radius: 14px;
        padding: 10px 16px;
        cursor: pointer;
        box-shadow: 0 2px 12px #0006, 0 0 0 3px #ffd70055;
      }
      .slot-layout > div:nth-child(2) {
        flex: 0 0 auto; /* ALTERA√á√ÉO: N√£o permite que o painel central cres√ßa ou diminua */
        width: 540px; /* ALTERA√á√ÉO: Largura fixa para o painel central */
        display: flex;
        flex-direction: column;
        align-items: center;
        /* ALTERA√á√ÉO: Painel central agora fica completamente centralizado */
      }
    </style>
  </head>

  <body>
    <div id="back-arrow" style="display: none">&#x2190;</div>

    <div id="intro-page" class="intro-page">
      <h1>TIGRINHO DO BEM</h1>
      <button id="start-button">START GAME</button>
      <button id="credits-button">CR√âDITOS</button>
    </div>

    <div id="game-container" class="container">
      <h1>TIGRINHO DO BEM</h1>

      <div class="slot-layout">
        <aside class="side-panel">
          <div class="game-info">
            <p id="username-display"></p>
            <p id="games-left"></p>
          </div>
        </aside>

        <div style="flex: 0 1 auto; min-width: 360px">
          <div class="slot-area" id="slot-area">
            <div class="slot-window">
              <div class="slot-strip" id="strip0"></div>
            </div>
            <div class="slot-window">
              <div class="slot-strip" id="strip1"></div>
            </div>
            <div class="slot-window">
              <div class="slot-strip" id="strip2"></div>
            </div>
          </div>

          <div class="game-buttons">
            <button id="spin-button">GIRAR!</button>
          </div>

          <div class="result" id="result"></div>

          <p
            style="
              margin-top: 24px;
              color: #ffd700;
              font-size: 1.05rem;
              font-family: 'Luckiest Guy', cursive, Arial, sans-serif;
              text-shadow: 2px 2px 8px #000a;
            "
          >
            <b>Obs:</b> Se alinhar 3 s√≠mbolos iguais na linha do meio, voc√™
            ganha!<br />
          </p>
        </div>

        <aside class="side-panel ranking-panel">
          <h3 class="title">RANKING</h3>
          <ol id="ranking-list" class="ranking-list"></ol>
        </aside>
      </div>
    </div>

    <div id="credits-page" class="credits-page">
      <h2>CR√âDITOS</h2>
      <p>Murilo Bueno de Godoy</p>
      <p>J√∫lia dos Santos Daniel</p>
      <p>M√°rcio Aparecido Muniz Junior</p>
      <p>Ana Clara Catelani</p>
      <p class="thanks">
        AGRADECEMOS MUITO por jogar e fazer parte da nossa jornada!
      </p>
      <button id="back-to-intro-button">VOLTAR</button>
    </div>

    <div id="score-page" class="score-page">
      <h1>RESULTADO FINAL</h1>
      <p id="final-username"></p>
      <p id="final-score"></p>
      <p id="final-rank"></p>
      <button id="play-again-button">JOGAR NOVAMENTE</button>
    </div>

    <div id="popup-overlay" class="popup-overlay"></div>
    <div id="popup-msg" class="popup-msg" style="display: none">
      <img id="mascote-img" src="mascote.jpg" alt="Mascote" />
      <div class="balao-fala" id="balao-fala"></div>
      <!-- ALTERA√á√ÉO: Bot√£o de fechar removido para for√ßar espera do tempo completo -->
    </div>

    <div id="name-overlay" class="popup-overlay"></div>
    <div id="name-popup" class="popup-msg" style="display: none">
      <img src="diego_ganhou.png" alt="Mascote" />
      <div class="balao-fala">
        <div>Digite seu nome para come√ßar:</div>
        <input id="name-input" type="text" placeholder="Seu nome" />
        <button id="name-confirm">COME√áAR</button>
      </div>
      <button class="popup-close" id="name-close" title="Fechar">
        &times;
      </button>
    </div>
    <script>
             // ======= Defina aqui os s√≠mbolos do ca√ßa-n√≠quel =======
       const symbols = [
         { img: "cj.jpg", label: "Mamaco" },
         { img: "mclovin.jpg", label: "McLovin" },
         { img: "sid.png", label: "Sid" },
         { img: "caramelo.jpg", label: "Caramelo" },
         { img: "felca.jpg", label: "Felca" },
         { img: "tueh.jpg", label: "Tueh" },
       ];

      const mascoteWinImg = "diego_ganhou.png";
      const mascoteLoseImg = "diego_perdeu.png";

      // Par√¢metros do slot
      const ROWS = 3;
      const COLS = 3;
      const SYMBOLS_PER_STRIP = symbols.length;
      const SYMBOL_HEIGHT = 140;
      const SPIN_DURATION_BASE = 2000;
      const SPIN_STOP_DELAY = 400;
      const POPUP_DELAY = 1000;
      const MAX_GAMES = 3;

      // VARI√ÅVEIS DO NOVO SISTEMA DE USU√ÅRIO E RANKING
      let currentUsername = "";
      let gamesPlayed = 0;
      let winsCount = 0;
      
      // ALTERA√á√ÉO: Vari√°veis de controle de estado para evitar bugs
      let isTransitioning = false; // Controla transi√ß√µes entre p√°ginas
      let isModalOpen = false; // Controla se algum modal est√° aberto
      let isGameActive = false; // Controla se o jogo est√° ativo

      /* ======= ALTERA√á√ÉO: ranking persistente entre jogadores (na mesma sess√£o) ======= */
      const ranking = []; // { name, wins, errors, rankText }  // ALTERA√á√ÉO

      // Elementos do jogo
      let strips = [[], [], []];
      let positions = [0, 0, 0];
      let spinning = false;

      const stripEls = [
        document.getElementById("strip0"),
        document.getElementById("strip1"),
        document.getElementById("strip2"),
      ];
      const spinBtn = document.getElementById("spin-button");
      const resultDiv = document.getElementById("result");
      const popup = document.getElementById("popup-msg");
      const popupOverlay = document.getElementById("popup-overlay");
      const fala = document.getElementById("balao-fala");
      const popupClose = document.getElementById("popup-close");
      const mascoteImg = document.getElementById("mascote-img");

      // NOVOS ELEMENTOS DO PLACAR
      const finalUsernameEl = document.getElementById("final-username");
      const finalScoreEl = document.getElementById("final-score");
      const finalRankEl = document.getElementById("final-rank");
      const playAgainBtn = document.getElementById("play-again-button");
      const usernameDisplayEl = document.getElementById("username-display");
      const gamesLeftEl = document.getElementById("games-left");

      /* ======= ALTERA√á√ÉO: ranking painel ======= */
      const rankingListEl = document.getElementById("ranking-list"); // ALTERA√á√ÉO

      // Elementos de navega√ß√£o
      const introPage = document.getElementById("intro-page");
      const gameContainer = document.getElementById("game-container");
      const creditsPage = document.getElementById("credits-page");
      const scorePage = document.getElementById("score-page"); // NOVO
      const startButton = document.getElementById("start-button");
      const creditsButton = document.getElementById("credits-button");
      const backToIntroButton = document.getElementById("back-to-intro-button");
      const backArrow = document.getElementById("back-arrow");

      /* ======= ALTERA√á√ÉO: popup de nome - elementos ======= */
      const nameOverlay = document.getElementById("name-overlay"); // ALTERA√á√ÉO
      const namePopup = document.getElementById("name-popup"); // ALTERA√á√ÉO
      const nameInput = document.getElementById("name-input"); // ALTERA√á√ÉO
      const nameConfirm = document.getElementById("name-confirm"); // ALTERA√á√ÉO
      const nameClose = document.getElementById("name-close"); // ALTERA√á√ÉO

      // Fun√ß√µes de navega√ß√£o com valida√ß√µes
      function showIntro() {
        // ALTERA√á√ÉO: Valida√ß√£o para evitar transi√ß√µes durante opera√ß√µes cr√≠ticas
        if (isTransitioning || spinning) {
          return;
        }
        
        isTransitioning = true;
        isGameActive = false;
        
        // ALTERA√á√ÉO: Fecha qualquer modal aberto antes de mudar de p√°gina
        closeAllModals();
        
        introPage.style.display = "flex";
        gameContainer.style.display = "none";
        creditsPage.style.display = "none";
        scorePage.style.display = "none";
        backArrow.style.display = "none";
        
        // ALTERA√á√ÉO: Libera transi√ß√µes ap√≥s um pequeno delay
        setTimeout(() => {
          isTransitioning = false;
        }, 300);
      }

      function showGame() {
        // ALTERA√á√ÉO: Valida√ß√£o para evitar transi√ß√µes durante opera√ß√µes cr√≠ticas
        if (isTransitioning) {
          return;
        }
        
        isTransitioning = true;
        isGameActive = true;
        
        // ALTERA√á√ÉO: Fecha qualquer modal aberto antes de mudar de p√°gina
        closeAllModals();
        
        introPage.style.display = "none";
        gameContainer.style.display = "block";
        creditsPage.style.display = "none";
        scorePage.style.display = "none";
        backArrow.style.display = "block";
        updateGameInfo();
        renderRanking(); /* ALTERA√á√ÉO: manter ranking vis√≠vel */
        
        // ALTERA√á√ÉO: Libera transi√ß√µes ap√≥s um pequeno delay
        setTimeout(() => {
          isTransitioning = false;
        }, 300);
      }

      function showCredits() {
        // ALTERA√á√ÉO: Valida√ß√£o para evitar transi√ß√µes durante opera√ß√µes cr√≠ticas
        if (isTransitioning) {
          return;
        }
        
        isTransitioning = true;
        isGameActive = false;
        
        // ALTERA√á√ÉO: Fecha qualquer modal aberto antes de mudar de p√°gina
        closeAllModals();
        
        introPage.style.display = "none";
        gameContainer.style.display = "none";
        creditsPage.style.display = "flex";
        scorePage.style.display = "none";
        backArrow.style.display = "none";
        
        // ALTERA√á√ÉO: Libera transi√ß√µes ap√≥s um pequeno delay
        setTimeout(() => {
          isTransitioning = false;
        }, 300);
      }

      function rankFromWins(w) {
        // ALTERA√á√ÉO: mesma classifica√ß√£o do seu placar
        if (w === 3) return "ROLETUDO";
        if (w === 2) return "MESTRE DA ROLETA";
        if (w === 1) return "ROLINHA";
        return "GAROTO";
      }

      function showScoreboard() {
        // ALTERA√á√ÉO: Valida√ß√£o para evitar transi√ß√µes durante opera√ß√µes cr√≠ticas
        if (isTransitioning) {
          return;
        }
        
        isTransitioning = true;
        isGameActive = false;
        
        // ALTERA√á√ÉO: Fecha qualquer modal aberto antes de mudar de p√°gina
        closeAllModals();
        
        gameContainer.style.display = "none";
        scorePage.style.display = "flex";
        backArrow.style.display = "none";

        /* ======= ALTERA√á√ÉO: ao finalizar, registra no ranking ======= */
        addCurrentPlayerToRanking(); // ALTERA√á√ÉO

        const rankText = rankFromWins(winsCount);

        finalUsernameEl.textContent = `Usu√°rio: ${currentUsername}`;
        finalScoreEl.textContent = `Acertos: ${winsCount} de ${MAX_GAMES}`;
        finalRankEl.textContent = `Ranking: ${rankText}`;
        
        // ALTERA√á√ÉO: Libera transi√ß√µes ap√≥s um pequeno delay
        setTimeout(() => {
          isTransitioning = false;
        }, 300);
      }

      function updateGameInfo() {
        usernameDisplayEl.textContent = `Usu√°rio: ${currentUsername}`;
        gamesLeftEl.textContent = `Jogadas: ${gamesPlayed} de ${MAX_GAMES}`;
      }

      // ALTERA√á√ÉO: Fun√ß√£o para fechar todos os modais
      function closeAllModals() {
        isModalOpen = false;
        nameOverlay.style.display = "none";
        namePopup.style.display = "none";
        popupOverlay.style.display = "none";
        popup.style.display = "none";
      }

      // ======= ALTERA√á√ÉO: fluxo de nome via POPUP, sem prompt() =======
      function openNamePopup() {
        // ALTERA√á√ÉO: Valida√ß√£o para evitar abrir modal se j√° houver um aberto
        if (isModalOpen || isTransitioning) {
          return;
        }
        
        isModalOpen = true;
        nameInput.value = "";
        nameOverlay.style.display = "block";
        namePopup.style.display = "flex";
        setTimeout(() => nameInput.focus(), 0);
      }
      function closeNamePopup() {
        // ALTERA√á√ÉO
        isModalOpen = false;
        nameOverlay.style.display = "none";
        namePopup.style.display = "none";
      }
      function confirmNameStart() {
        // ALTERA√á√ÉO: Valida√ß√µes adicionais para o nome do usu√°rio
        const username = (nameInput.value || "").trim();
        if (!username || username.length < 2 || username.length > 20) {
          // ALTERA√á√ÉO: Mostra mensagem de erro se o nome for inv√°lido
          alert("Por favor, digite um nome v√°lido (entre 2 e 20 caracteres).");
          return;
        }
        
        // ALTERA√á√ÉO: Verifica se o nome j√° existe no ranking
        const existingPlayer = ranking.find(player => player.name.toLowerCase() === username.toLowerCase());
        if (existingPlayer) {
          const confirmReplace = confirm(`O usu√°rio "${username}" j√° existe no ranking. Deseja continuar com este nome?`);
          if (!confirmReplace) {
            return;
          }
        }
        
        currentUsername = username;
        gamesPlayed = 0;
        winsCount = 0;
        
        // ALTERA√á√ÉO: Reseta o bot√£o para um novo jogo
        spinBtn.disabled = false;
        spinBtn.textContent = "GIRAR!";
        
        closeNamePopup();
        showGame();
      }

      // Inicializa as strips com s√≠mbolos aleat√≥rios
      function initStrips() {
        for (let c = 0; c < COLS; c++) {
          strips[c] = [];
          for (let i = 0; i < SYMBOLS_PER_STRIP * 3; i++) {
            strips[c].push(symbols[Math.floor(Math.random() * symbols.length)]);
          }
        }
      }

      // NOVA L√ìGICA: Renderiza as strips com as cartas ganhadoras
      function renderStrips() {
        for (let c = 0; c < COLS; c++) {
          stripEls[c].innerHTML = "";
          for (let i = 0; i < strips[c].length; i++) {
            let div = document.createElement("div");
            div.className = "slot-symbol";
            // NOVA L√ìGICA: Linha premiada √© a linha do meio (posi√ß√£o 10)
            if (i === 10) div.className += " linha-premiada";
            if (strips[c][i].img) {
              let img = document.createElement("img");
              img.src = strips[c][i].img;
              img.alt = strips[c][i].label;
              div.appendChild(img);
            }
            stripEls[c].appendChild(div);
          }
        }
      }

      // NOVA L√ìGICA: Gira as colunas com anima√ß√£o visual e resultado pr√©-determinado
      async function spinSlots() {
        // ALTERA√á√ÉO: Valida√ß√µes adicionais para evitar bugs
        if (spinning || gamesPlayed >= MAX_GAMES || isTransitioning || isModalOpen || !isGameActive || spinBtn.disabled) {
          if (gamesPlayed >= MAX_GAMES) {
            showScoreboard();
          }
          return;
        }

        spinning = true;
        spinBtn.disabled = true;
        resultDiv.textContent = "";

        // NOVA L√ìGICA: Sorteia as 3 cartas ganhadoras ANTES da anima√ß√£o
        const winningCards = [
          symbols[Math.floor(Math.random() * symbols.length)],
          symbols[Math.floor(Math.random() * symbols.length)],
          symbols[Math.floor(Math.random() * symbols.length)]
        ];

        // NOVA L√ìGICA: Cria strips com anima√ß√£o visual
        for (let c = 0; c < COLS; c++) {
          // Cria uma strip com muitos s√≠mbolos para dar efeito de rolagem
          let strip = [];
          for (let i = 0; i < 20; i++) { // 20 s√≠mbolos para rolagem longa
            strip.push(symbols[Math.floor(Math.random() * symbols.length)]);
          }
          // Coloca a carta ganhadora na posi√ß√£o final (linha do meio)
          strip[10] = winningCards[c]; // Posi√ß√£o 10 = linha do meio
          strips[c] = strip;
        }
        
        // ALTERA√á√ÉO: Debug removido

        // NOVA L√ìGICA: Anima√ß√£o de rolagem visual
        await animateSpinning();

        // NOVA L√ìGICA: Para na posi√ß√£o correta (linha do meio)
        await stopAtWinningPosition();

        spinning = false;

        // INCREMENTA O N√öMERO DE JOGADAS
        gamesPlayed++;
        updateGameInfo();
        
        // ALTERA√á√ÉO: Se atingiu o m√°ximo de jogadas, desabilita o bot√£o permanentemente
        if (gamesPlayed >= MAX_GAMES) {
          spinBtn.disabled = true;
          spinBtn.textContent = "JOGO FINALIZADO";
        } else {
          // ALTERA√á√ÉO: S√≥ reabilita o bot√£o se ainda n√£o atingiu o m√°ximo de jogadas
          spinBtn.disabled = false;
        }

        setTimeout(() => {
          checkResult(winningCards); // Passa as cartas ganhadoras
        }, POPUP_DELAY);
      }

      // NOVA FUN√á√ÉO: Anima√ß√£o de rolagem r√°pida por 3 segundos
      async function animateSpinning() {
        return new Promise((resolve) => {
          const totalDuration = 3000; // 3 segundos total
          const startTime = Date.now();
          
          function animate() {
            const elapsed = Date.now() - startTime;
            const progress = Math.min(elapsed / totalDuration, 1);
            
            // Todas as colunas rolam juntas por 3 segundos com velocidade alta
            for (let c = 0; c < COLS; c++) {
              // Velocidade alta e constante durante os 3 segundos
              const speed = 15; // Velocidade alta para in√≠cio imediato
              const offset = (elapsed / 20) * speed; // Offset baseado no tempo (mais r√°pido)
              
              stripEls[c].style.transform = `translateY(-${offset}px)`;
              stripEls[c].style.transition = `none`;
            }
            
            if (progress < 1) {
              requestAnimationFrame(animate);
            } else {
              resolve();
            }
          }
          
          animate();
        });
      }

      // NOVA FUN√á√ÉO: Para uma coluna de cada vez de forma fluida
      async function stopAtWinningPosition() {
        return new Promise((resolve) => {
          // Renderiza as strips com as cartas ganhadoras na linha do meio
          renderStrips();
          
          // Para uma coluna de cada vez com intervalo de 400ms para ser mais fluido
          for (let c = 0; c < COLS; c++) {
            setTimeout(() => {
              // Posi√ß√£o 10 √© onde est√° a carta ganhadora, ajusta para mostrar na linha do meio
              const targetPosition = 10 * SYMBOL_HEIGHT - (1 * SYMBOL_HEIGHT);
              stripEls[c].style.transform = `translateY(-${targetPosition}px)`;
              stripEls[c].style.transition = `transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94)`;
            }, c * 400); // 400ms de diferen√ßa entre cada coluna para ser mais fluido
          }
          
          // Resolve ap√≥s todas as colunas pararem (3 colunas * 400ms + 800ms de transi√ß√£o)
          setTimeout(() => {
            resolve();
          }, (COLS * 400) + 800);
        });
      }

      /* ======= NOVA L√ìGICA: verifica resultado das cartas ganhadoras ======= */
      function checkResult(winningCards) {
        // NOVA L√ìGICA: Usa as cartas ganhadoras diretamente
        const resultCards = winningCards;

        // NOVA L√ìGICA: Verifica se as 3 cartas sorteadas s√£o iguais
        const isWin = resultCards[0].label === resultCards[1].label &&
                     resultCards[1].label === resultCards[2].label;

        if (isWin) {
          winsCount++; // INCREMENTA AS VIT√ìRIAS
          mascoteImg.src = mascoteWinImg;
          fala.innerHTML = `Parab√©ns! <br>Voc√™ ganhou um pr√™mio!`;
          resultDiv.textContent = "üèÜ Voc√™ GANHOU! üèÜ";
        } else {
          mascoteImg.src = mascoteLoseImg;
          fala.innerHTML = `N√£o foi dessa vez!<br>Tente novamente!`;
          resultDiv.textContent = "üòî Tente novamente... üòî";
        }

        // ALTERA√á√ÉO: Valida√ß√£o para evitar abrir modal se j√° houver um aberto
        if (!isModalOpen && !isTransitioning) {
          isModalOpen = true;
          popupOverlay.style.display = "block";
          popup.style.display = "flex";
          
          // ALTERA√á√ÉO: Mant√©m o bot√£o desabilitado durante a exibi√ß√£o do modal
          spinBtn.disabled = true;
          
          // ALTERA√á√ÉO: Modal bloqueado - usu√°rio deve esperar o tempo completo
          setTimeout(() => {
            isModalOpen = false;
            popupOverlay.style.display = "none";
            popup.style.display = "none";
            
            // ALTERA√á√ÉO: S√≥ reabilita o bot√£o se ainda n√£o atingiu o m√°ximo de jogadas
            if (gamesPlayed < MAX_GAMES) {
              spinBtn.disabled = false;
            }
            
            // Se atingir m√°ximo de jogadas, mostra placar final
            if (gamesPlayed >= MAX_GAMES) {
              showScoreboard();
            }
          }, 4000); // ALTERA√á√ÉO: Aumentei para 4 segundos para dar mais tempo
        }
      }

      // ======= ALTERA√á√ÉO: adiciona jogador atual ao ranking (sem duplicatas) =======
      function addCurrentPlayerToRanking() {
        // ALTERA√á√ÉO: Verifica se o usu√°rio j√° existe no ranking
        const existingPlayerIndex = ranking.findIndex(player => player.name === currentUsername);
        
        const entry = {
          name: currentUsername,
          wins: winsCount,
          errors: MAX_GAMES - winsCount,
          rankText: rankFromWins(winsCount),
        };
        
        if (existingPlayerIndex !== -1) {
          // ALTERA√á√ÉO: Se o usu√°rio j√° existe, atualiza seus dados
          ranking[existingPlayerIndex] = entry;
        } else {
          // ALTERA√á√ÉO: Se √© um novo usu√°rio, adiciona ao ranking
          ranking.push(entry);
        }
        
        renderRanking();
      }

      // ======= ALTERA√á√ÉO: renderiza ranking √† direita =======
      function renderRanking() {
        // ALTERA√á√ÉO
        rankingListEl.innerHTML = "";
        // Ordena por vit√≥rias desc, depois por menos erros
        const ordered = [...ranking].sort(
          (a, b) => b.wins - a.wins || a.errors - b.errors
        );
        ordered.forEach((p, i) => {
          const li = document.createElement("li");
          li.className = "ranking-item";
          li.textContent = `${i + 1}¬∫ ‚Ä¢ ${p.name} ‚Äî ${p.wins} acertos, ${
            p.errors
          } erros ‚Ä¢ ${p.rankText}`;
          rankingListEl.appendChild(li);
        });
      }

      // ALTERA√á√ÉO: Event listeners de fechar popup removidos para for√ßar espera do tempo completo

      // ======= ALTERA√á√ÉO: listeners do popup de nome =======
      startButton.onclick = openNamePopup; // ALTERA√á√ÉO (antes chamava prompt)
      nameConfirm.onclick = confirmNameStart; // ALTERA√á√ÉO
      nameClose.onclick = closeNamePopup; // ALTERA√á√ÉO
      nameOverlay.onclick = closeNamePopup; // ALTERA√á√ÉO
      nameInput.addEventListener("keydown", (e) => {
        // ENTER confirma
        if (e.key === "Enter") confirmNameStart();
      }); // ALTERA√á√ÉO

      // Event Listeners para os bot√µes de navega√ß√£o com valida√ß√µes
      // startButton.onclick = startGameWithUsername; // (desativado) // ORIGINAL
      creditsButton.onclick = function() {
        if (!isTransitioning && !isModalOpen) {
          showCredits();
        }
      };
      backToIntroButton.onclick = function() {
        if (!isTransitioning && !isModalOpen) {
          showIntro();
        }
      };
      backArrow.onclick = function() {
        if (!isTransitioning && !isModalOpen) {
          showIntro();
        }
      };
      spinBtn.onclick = function() {
        // ALTERA√á√ÉO: Valida√ß√µes mais rigorosas para evitar cliques m√∫ltiplos
        if (!isTransitioning && !isModalOpen && isGameActive && !spinning && !spinBtn.disabled) {
          spinSlots();
        }
      };
      playAgainBtn.onclick = function() {
        if (!isTransitioning && !isModalOpen) {
          showIntro();
        }
      }; // NOVO
      
      // ALTERA√á√ÉO: Event listener do debug removido

      // Inicializa√ß√£o
      initStrips();
      renderStrips();
      showIntro();
    </script>
  </body>
</html>
